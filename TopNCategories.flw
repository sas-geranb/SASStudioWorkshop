{"creationTimeStamp":"2024-05-17T15:09:12.322Z","modifiedTimeStamp":"2024-05-17T15:09:12.322Z","createdBy":null,"modifiedBy":null,"version":2,"id":null,"name":"TopNCategories.flw","description":null,"properties":{},"links":[],"nodes":{"0":{"nodeType":"step","version":1,"id":"0","name":"MEANS","stepUri":"/dataFlows/steps/a7190700-f59c-4a94-afe2-214ce639fcde","arguments":{"codeOptions":{"code":"/*************************************************/\n/* Copyright 2008-2010 SAS Institute Inc.        */\n/* Top N report for data across categories       */\n/* Use macro variables to customize the data     */\n/* source.                                       */\n/* DATA - SAS library.member for input data      */\n/* REPORT - column to report on                  */\n/* MEASURE - column to measure for the report    */\n/* MEASUREFORMAT - specify to preserve measure   */\n/*  format in the report (currency, for example) */\n/* STAT - SUM or MEAN                            */\n/* N - The \"N\" in Top N - how many to show       */ \n/* CATEGORY - across which category?             */ \n/*************************************************/\n%let data=SASHELP.CARS;\n%let report=Model;\n%let measure=MPG_City;\n%let measureformat=%str(format=BEST6.);\n%let stat=MEAN;\n%let n=5;\n%let category=Origin;\ntitle \"Top Models by MPG_City for each region of Origin\";\nfootnote;\n/* summarize the data across a category and store */\n/* the output in an output data set */\nproc means data=&data &stat noprint;\n\tvar &measure;\n\tclass &category &report;\n\toutput out=summary &stat=&measure &category /levels;\nrun;\n/* store the value of the measure for ALL rows and \n/* the row count into a macro variable for use  */\n/* later in the report */","variables":[{"name":"_input1","value":{"portIndex":0,"portName":"inTables","referenceType":"inputPort"}},{"name":"_output1","value":{"portIndex":0,"portName":"outTables","referenceType":"outputPort"}}]}}},"1":{"nodeType":"step","version":1,"id":"1","name":"SQL","stepUri":"/dataFlows/steps/a7190700-f59c-4a94-afe2-214ce639fcde","arguments":{"codeOptions":{"code":"proc sql noprint;\nselect &measure,_FREQ_ into :overall,:numobs\nfrom summary where _TYPE_=0;\nselect count(distinct &category) into :categorycount from summary;\nquit;\n/* sort the results so that we get the TOP values */\n/* rising to the top of the data set */","variables":[{"name":"_input1","value":{"portIndex":0,"portName":"inTables","referenceType":"inputPort"}}]}}},"2":{"nodeType":"step","version":1,"id":"2","name":"SORT","stepUri":"/dataFlows/steps/a7190700-f59c-4a94-afe2-214ce639fcde","arguments":{"codeOptions":{"code":"proc sort data=work.summary out=work.topn;\n  where _type_>2;\n  by &category descending &measure;\nrun;\n/* Pass through the data and output the first N */\n/* values for each category */","variables":[{"name":"_input1","value":{"portIndex":0,"portName":"inTables","referenceType":"inputPort"}},{"name":"_output1","value":{"portIndex":0,"portName":"outTables","referenceType":"outputPort"}}]}}},"3":{"nodeType":"step","version":1,"id":"3","name":"DATASTEP","stepUri":"/dataFlows/steps/a7190700-f59c-4a94-afe2-214ce639fcde","arguments":{"codeOptions":{"code":"data topn;\n  length rank 8;\n  label rank=\"Rank\";\n  set topn;\n  by &category descending &measure;\n  if first.&category then rank=0;\n  rank+1;\n  if rank le &n then output;\nrun;\n/* Create a report listing for the top values in each category */\nfootnote2 \"&stat of &measure for ALL values of &report: &overall (&numobs total rows)\";","variables":[{"name":"_input1","value":{"portIndex":0,"portName":"inTables","referenceType":"inputPort"}},{"name":"_output1","value":{"portIndex":0,"portName":"outTables","referenceType":"outputPort"}}]}}},"4":{"nodeType":"step","version":1,"id":"4","name":"REPORT","stepUri":"/dataFlows/steps/a7190700-f59c-4a94-afe2-214ce639fcde","arguments":{"codeOptions":{"code":"proc report data=topn;\n\tcolumn &category rank &report &measure;\n\tdefine &category /group;\n\tdefine rank /display;\n\tdefine &measure / analysis &measureformat;\t\nrun;\nquit; \n/* Create a simple bar graph for the data to show the rankings */\n/* and relative values */\n/* Calculate size of chart based on number of category values */\ngoptions ypixels=%eval(250 * &categorycount) xpixels=500;","variables":[{"name":"_input1","value":{"portIndex":0,"portName":"inTables","referenceType":"inputPort"}}]}}},"5":{"nodeType":"step","version":1,"id":"5","name":"GCHART","stepUri":"/dataFlows/steps/a7190700-f59c-4a94-afe2-214ce639fcde","arguments":{"codeOptions":{"code":"proc gchart data=topn\n;\n\thbar &report / \n\t\tsumvar=&measure\n\t\tgroup=&category\n\t\tdescending\n\t\tnozero\n\t\tclipref\n\t\tframe\t\n\t\tdiscrete\n\t\ttype=&stat\n\t\tpatternid=group\n;\nrun;\nquit;","variables":[{"name":"_input1","value":{"portIndex":0,"portName":"inTables","referenceType":"inputPort"}}]}}},"SASHELP.CARS.DATA.0":{"nodeType":"table","version":1,"id":"SASHELP.CARS.DATA.0","name":"CARS","properties":{},"tableReference":{"referenceType":"parameter","parameterId":"c09f5ea9-9242-4b67-b48a-51b1e4e866d1"}},"WORK.SUMMARY.DATA.0":{"nodeType":"outputTable","version":1,"id":"WORK.SUMMARY.DATA.0","name":"SUMMARY","properties":{},"tableReference":{"referenceType":"parameter","parameterId":"b0f85b1f-6bb0-46d4-95f6-79371ce8dc8d"},"outputTableArguments":{"advancedOptions":[],"arguments":{}}},"WORK.TOPN.DATA.0":{"nodeType":"outputTable","version":1,"id":"WORK.TOPN.DATA.0","name":"TOPN","properties":{},"tableReference":{"referenceType":"parameter","parameterId":"268a03b9-aaee-484c-a2e1-169b108d3320"},"outputTableArguments":{"advancedOptions":[],"arguments":{}}},"WORK.TOPN.DATA.1":{"nodeType":"outputTable","version":1,"id":"WORK.TOPN.DATA.1","name":"TOPN","properties":{},"tableReference":{"referenceType":"parameter","parameterId":"960aa3b0-c53a-4839-a1f9-42c299c315c7"},"outputTableArguments":{"advancedOptions":[],"arguments":{}}}},"parameters":{"268a03b9-aaee-484c-a2e1-169b108d3320":{"parameterType":"table","version":1,"id":"268a03b9-aaee-484c-a2e1-169b108d3320","name":"TOPN","parameterUsage":"INPUT_OUTPUT","defaultValue":{"table":{"creationTimeStamp":"2024-05-17T15:09:12.322278616Z","modifiedTimeStamp":"2024-05-17T15:09:12.322278705Z","name":"TOPN","type":"DATA"},"source":{"creationTimeStamp":"2024-05-17T15:09:12.32207988Z","modifiedTimeStamp":"2024-05-17T15:09:12.32207997Z","id":"5f81c108-e4be-40d4-a69d-72548781f94c","name":"WORK","hasTables":false,"hasEngines":true}}},"960aa3b0-c53a-4839-a1f9-42c299c315c7":{"parameterType":"table","version":1,"id":"960aa3b0-c53a-4839-a1f9-42c299c315c7","name":"TOPN","parameterUsage":"INPUT_OUTPUT","defaultValue":{"table":{"creationTimeStamp":"2024-05-17T15:09:12.322281829Z","modifiedTimeStamp":"2024-05-17T15:09:12.322281885Z","name":"TOPN","type":"DATA"},"source":{"creationTimeStamp":"2024-05-17T15:09:12.32207988Z","modifiedTimeStamp":"2024-05-17T15:09:12.32207997Z","id":"5f81c108-e4be-40d4-a69d-72548781f94c","name":"WORK","hasTables":false,"hasEngines":true}}},"b0f85b1f-6bb0-46d4-95f6-79371ce8dc8d":{"parameterType":"table","version":1,"id":"b0f85b1f-6bb0-46d4-95f6-79371ce8dc8d","name":"SUMMARY","parameterUsage":"INPUT_OUTPUT","defaultValue":{"table":{"creationTimeStamp":"2024-05-17T15:09:12.32227576Z","modifiedTimeStamp":"2024-05-17T15:09:12.322275875Z","name":"SUMMARY","type":"DATA"},"source":{"creationTimeStamp":"2024-05-17T15:09:12.32207988Z","modifiedTimeStamp":"2024-05-17T15:09:12.32207997Z","id":"5f81c108-e4be-40d4-a69d-72548781f94c","name":"WORK","hasTables":false,"hasEngines":true}}},"c09f5ea9-9242-4b67-b48a-51b1e4e866d1":{"parameterType":"tableStructure","version":2,"id":"c09f5ea9-9242-4b67-b48a-51b1e4e866d1","name":"CARS","parameterUsage":"INPUT","defaultValue":{"table":{"creationTimeStamp":"2024-05-17T15:09:12.322085967Z","modifiedTimeStamp":"2024-05-17T15:09:12.322086055Z","name":"CARS","type":"DATA"},"source":{"creationTimeStamp":"2024-05-17T15:09:12.322077744Z","modifiedTimeStamp":"2024-05-17T15:09:12.322077826Z","id":"37dd4efc-b493-46d9-aad2-d7d404307469","name":"SASHELP","hasTables":false,"hasEngines":true},"columns":[{"name":"EngineSize","label":"Engine Size (L)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"DriveTrain","index":0,"type":"CHARACTER","rawLength":5,"formattedLength":5,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Cylinders","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Wheelbase","label":"Wheelbase (IN)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Length","label":"Length (IN)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"MPG_Highway","label":"MPG (Highway)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"MPG_City","label":"MPG (City)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Type","index":0,"type":"CHARACTER","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Horsepower","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Weight","label":"Weight (LBS)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Origin","index":0,"type":"CHARACTER","rawLength":6,"formattedLength":6,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"MSRP","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"name":"DOLLAR","length":8,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Make","index":0,"type":"CHARACTER","rawLength":13,"formattedLength":13,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Invoice","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"format":{"name":"DOLLAR","length":8,"decimals":0},"informat":{"length":0,"decimals":0}},{"name":"Model","index":0,"type":"CHARACTER","rawLength":40,"formattedLength":40,"indexed":false,"format":{"length":0,"decimals":0},"informat":{"length":0,"decimals":0}}]},"columns":[{"name":"EngineSize","label":"Engine Size (L)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"DriveTrain","index":0,"type":"CHARACTER","rawLength":5,"formattedLength":5,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Cylinders","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Wheelbase","label":"Wheelbase (IN)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Length","label":"Length (IN)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"MPG_Highway","label":"MPG (Highway)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"MPG_City","label":"MPG (City)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Type","index":0,"type":"CHARACTER","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Horsepower","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Weight","label":"Weight (LBS)","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Origin","index":0,"type":"CHARACTER","rawLength":6,"formattedLength":6,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"MSRP","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":"DOLLAR","length":8,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Make","index":0,"type":"CHARACTER","rawLength":13,"formattedLength":13,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Invoice","index":0,"type":"NUMERIC","rawLength":8,"formattedLength":8,"indexed":false,"version":2,"format":{"name":"DOLLAR","length":8,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}},{"name":"Model","index":0,"type":"CHARACTER","rawLength":40,"formattedLength":40,"indexed":false,"version":2,"format":{"name":null,"length":0,"decimals":0},"informat":{"name":null,"length":0,"decimals":0}}]}},"connections":[{"sourcePort":{"node":"SASHELP.CARS.DATA.0","portName":"outTable","index":0},"targetPort":{"node":"0","portName":"inTables","index":0}},{"sourcePort":{"node":"0","portName":"outTables","index":0},"targetPort":{"node":"WORK.SUMMARY.DATA.0","portName":"inTable","index":0}},{"sourcePort":{"node":"WORK.SUMMARY.DATA.0","portName":"outTable","index":0},"targetPort":{"node":"1","portName":"inTables","index":0}},{"sourcePort":{"node":"WORK.SUMMARY.DATA.0","portName":"outTable","index":0},"targetPort":{"node":"2","portName":"inTables","index":0}},{"sourcePort":{"node":"2","portName":"outTables","index":0},"targetPort":{"node":"WORK.TOPN.DATA.0","portName":"inTable","index":0}},{"sourcePort":{"node":"WORK.TOPN.DATA.0","portName":"outTable","index":0},"targetPort":{"node":"3","portName":"inTables","index":0}},{"sourcePort":{"node":"3","portName":"outTables","index":0},"targetPort":{"node":"WORK.TOPN.DATA.1","portName":"inTable","index":0}},{"sourcePort":{"node":"WORK.TOPN.DATA.1","portName":"outTable","index":0},"targetPort":{"node":"4","portName":"inTables","index":0}},{"sourcePort":{"node":"WORK.TOPN.DATA.1","portName":"outTable","index":0},"targetPort":{"node":"5","portName":"inTables","index":0}}],"extendedProperties":{},"stickyNotes":[]}